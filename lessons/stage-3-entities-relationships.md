# Stage 3: Entities & Relationships ๐๐ฆ

ุงููุฑุญูุฉ ุงูุญุงููุฉ ุชุฑูุฒ ุนูู ุจูุงุก ุงูุนูุงูุงุช ุจูู ุงูููุงูุงุช ุงูููุฏุณูุฉุ ูุชุญููู ุณุญุงุจุฉ ุงูููุงุท ุฅูู ูููู ููุฏุณู ูุชูุงูู.

## ุฌุฏูู ุงููุญุชููุงุช
1. [ูุธุงู ุงูุฎุทูุท (Lines System)](#ูุธุงู-ุงูุฎุทูุท)
2. [ุงูุฑุจุท ุนุจุฑ ุงููุนุฑูุงุช (ID-based Linking)](#ุงูุฑุจุท-ุจุงููุนุฑูุงุช)
3. [ุงูุนูู ุงูุชููู: ุญููู ูุงุฌูุฉ ุงูู CAD](#ุงูุนูู-ุงูุชููู)

---

## 1. ูุธุงู ุงูุฎุทูุท (Lines System) {#ูุธุงู-ุงูุฎุทูุท}

ุจุฏุฃูุง ุจุชุนุฑูู `VLine` ููุฑุจุท ุจูู ููุทุชูู. ุงูุฎุท ูู Valentina ููุณ ูุฌุฑุฏ ุฑุณูุ ุจู ูู ุนูุงูุฉ ุฑูุงุถูุฉ ุชุญูู ุฎุตุงุฆุต ูุซู ุงูุทูู ูุงูุฒุงููุฉ.

```rust
#[derive(Debug, Clone)]
pub struct VLine {
    pub metadata: VGObject,
    pub start_point_id: u32,
    pub end_point_id: u32,
}
```

---

## 2. ุงูุฑุจุท ุนุจุฑ ุงููุนุฑูุงุช (ID-based Linking) {#ุงูุฑุจุท-ุจุงููุนุฑูุงุช}

ูุชุฌูุจ ุชุนููุฏุงุช ุงูู Borrow Checker ูู Rustุ ุงุชุฎุฐูุง ูุฑุงุฑุงู ุจุฑุจุท ุงููุงุฆูุงุช ุนุจุฑ **ุงููุนุฑูุงุช (IDs)** ุจุฏูุงู ูู ุงููุฑุงุฌุน ุงููุจุงุดุฑุฉ. ูุฐุง ูุณูุญ ุจุชุนุฏูู ุงูููุงุท ุจุดูู ูุณุชูู ุฏูู ูุณุฑ ููููุฉ ุงูุฎุทูุท.

---

## 3. ุงูุนูู ุงูุชููู: ุญููู ูุงุฌูุฉ ุงูู CAD {#ุงูุนูู-ุงูุชููู}

ุฎูุงู ุชุทููุฑ ูุฐู ุงููุฑุญูุฉุ ูุงุฌููุง ุชุญุฏูุงุช ุชูููุฉ ูู ุจูุฆุฉ **Dioxus 0.7** ููููุง ุจุญููุง ุจุฃุณุงููุจ ููุฏุณูุฉ:

### ุฃ. ูุนุถูุฉ ุงูุฅุญุฏุงุซูุงุช (Coordinate Mapping)
ุงูุชุดููุง ุฃู ุฅุญุฏุงุซูุงุช ุงููุงูุณ (CSS Pixels) ุชุฎุชูู ุนู ุฅุญุฏุงุซูุงุช ุงูู SVG (ViewBox Units).
- **ุงูุญู:** ุจูุงุก ููุฏููู `canvas_coords` ุงูุฐู ูุณุชุฎุฏู ููุฏ JavaScript ุนุจุฑ `eval()` ูุฌูุจ ุฃุจุนุงุฏ ุงูุดุงุดุฉ ุงููุนููุฉุ ุซู ุชุทุจูู ูุนุงุฏูุงุช ุงูุชุญููู ุงูุฑูุงุถู ูุถูุงู ุธููุฑ ุงูููุทุฉ ุชุญุช ุงููุงูุณ ุจุฏูุฉ 100%.

### ุจ. ุขูุฉ ุงูุญุงูุฉ ููุชูุงุนู (Interaction State Machine)
ุงูุงุนุชูุงุฏ ุนูู ุฅููุงู ุงูุชุดุงุฑ ุงูุฃุญุฏุงุซ (`stop_propagation`) ูู ููู ูุงููุงู.
- **ุงูุญู:** ุงุณุชุฎุฏููุง `CanvasMode` (Enum) ููุชุญูู ูู ุณููู ุงูุจุฑูุงูุฌ:
    - ูุถุน `PlacePoint`: ูุฅุถุงูุฉ ุงูููุงุท.
    - ูุถุน `AwaitingLineStart/End`: ูุงุฎุชูุงุฑ ุงูููุงุท ูุชูุตูููุง.

### ุฌ. ุงูุฃุฏุงุก ูุชุฌูุจ ุงูู Deadlocks
ูู Rustุ ุงููุตูู ุงููุชุฒุงูู ููุจูุงูุงุช ุญุณุงุณ ุฌุฏุงู.
- **ุงูุญู:** ุงุณุชุฎุฏุงู ุชูููุฉ **Snapshotting** (ุฃุฎุฐ ููุทุฉ ูู ุงูุจูุงูุงุช ุนุจุฑ `.clone()`) ูุจู ุงูุจุฏุก ูู ุนูููุฉ ุงูุฑุณู (Rendering)ุ ููุง ูููุน ุญุฏูุซ ุชุฌูุฏ ูู ุงูุจุฑูุงูุฌ ุนูุฏ ูุญุงููุฉ ุงููุฑุงุกุฉ ูุงููุชุงุจุฉ ูู ููุณ ุงูููุช.

---

## ๐ ูุง ุงููุงุฏู ูู ุงููุฑุญูุฉ ุงูุซุงูุซุฉุ
- **Task 3.2:** ุฅุถุงูุฉ ุงูููุญููุงุช (Curves/Splines).
- **Task 3.3:** ุชุณููุงุช ุงูููุงุท (Labels) ุฏุงุฎู ุงูู Canvas.
- **Task 3.4:** ุนูููุงุช ุงูุญุฐู ูุงูุชุนุฏูู ุงููุชูุฏูุฉ.
